{% extends "base.html" %}
{% load static %}

{% block title %}Menu{% endblock title %}

{% block content %}

<!-- First gallery section start -->
<div class="main-container">
    <!-- Sidebar -->
    <div class="sidebar">
        <h1 class="center-text">Explore Our Menu</h1>
        <h3>Choose from a diverse menu featuring a delectable array of dishes.
            <br> Our mission is to satisfy your cravings and elevate your dining experience, one delicious meal at a time.
        </h3>
    </div>
</div>
<!-- First gallery section end -->

<!-- Second gallery section (Today's Special) -->
<!-- Today's Special Section -->
<div class="specials-container">
    <h1 class="text-center">Today's Special</h1>
    <h3 class="text-center subtitle">Handpicked dishes just for you</h3>
    
    <div class="specials-carousel">
        {% for special in todays_specials %}
        <div class="special-item-card" data-category="{{ special.category.name }}">
            <div class="special-item-img">
                <img src="{{ special.image.url }}" alt="{{ special.name }}">
                {% if special.is_vegetarian %}
                <span class="veg-indicator veg">VEG</span>
                {% else %}
                <span class="veg-indicator non-veg">NON-VEG</span>
                {% endif %}
                <div class="special-badge">Today's Special</div>
            </div>
            <div class="special-item-details">
                <h3>{{ special.name }}</h3>
                <p class="item-description">{{ special.description }}</p>
                <div class="price-addcart">
                    <div class="price-container">
                        {% if special.discounted_price %}
                        <span class="original-price">Rs {{ special.price }}</span>
                        <span class="item-price">Rs {{ special.discounted_price }}</span>
                        {% else %}
                        <span class="item-price">Rs {{ special.price }}</span>
                        {% endif %}
                    </div>
                    <div class="quantity-controls">
                        <button class="quantity-btn minus">-</button>
                        <span class="quantity">1</span>
                        <button class="quantity-btn plus">+</button>
                    </div>
                    <button class="add-to-cart-btn" data-id="{{ special.id }}">
                        <i class="fas fa-shopping-cart"></i> Add
                    </button>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="no-specials">
            <p>No specials available today. Check back tomorrow!</p>
        </div>
        {% endfor %}
    </div>
</div>

<!-- Second gallery section end -->

<!-- Enhanced Menu Section -->
<div class="menu-container">
    <h1 class="text-center">Our Menu</h1>
    
    <!-- Search Bar -->
    <form action="{% url 'menu' %}" method="get" class="search-container">
        <input type="text" id="menu-search" name="q" placeholder="Search for dishes..." class="search-input" value="{{ search_query }}">
        <button type="submit" class="search-btn"><i class="fas fa-search"></i></button>
    </form>

    <!-- Search Feedback -->
    <div id="search-feedback" class="search-feedback {% if foods|length == 0 %}show{% endif %}">
        <p>No items found matching your search.</p>
    </div>

    <!-- Category Filter -->
    <div class="category-filter">
        <div class="category-scroll">
            <button class="category-btn {% if not selected_category %}active{% endif %}" data-category="all">
                All Items
            </button>
            {% for category in categories %}
            <button class="category-btn {% if selected_category == category %}active{% endif %}" 
                    data-category="{{ category.name }}">
                {{ category.name }}
            </button>
            {% endfor %}
        </div>
    </div>
    
    <!-- Menu Items Grid -->
    <div class="menu-items-grid" id="menu-items-container">
        {% for food in foods %}
        <div class="menu-item-card" data-category="{% if food.category %}{{ food.category.name }}{% else %}uncategorized{% endif %}">
            <div class="menu-item-img">
                <img src="{{ food.image.url }}" alt="{{ food.title }}">
                {% if food.category %}
                <span class="category-badge">{{ food.category.name }}</span>
                {% endif %}
            </div>
            <div class="menu-item-details">
                <h3>{{ food.title }}</h3>
                <p class="item-description">{{ food.description }}</p>
                <div class="price-addcart">
                    <span class="item-price">Rs {{ food.price }}</span>
                    <button class="add-to-cart-btn" data-id="{{ food.id }}">
                        <i class="fas fa-shopping-cart"></i> Add to Cart
                    </button>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="no-items">
            <p>No food items available in this category.</p>
        </div>
        {% endfor %}
    </div>
</div>

{% endblock content %}

{% block extra_js %}
<script src="{% static 'js/menu.js' %}"></script>
{% endblock %}
